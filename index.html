<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Weather App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">  
    <link rel="shortcut icon" href="assets/cloud.png" type="">
</head>
  <body>
   <div class="searchBar">
         <div class=" searchBarparentDiv">
            <input type="text" class="inputfield" placeholder="Search City">
            <img src="assets/search.jpg" alt="" width="35px" class="searchIcon"  onclick="fetchData()">
         </div>
   </div>
   <div class="mainContentParentDiv d-flex">
    <div class="leftDiv">
        <div class="currentTempDiv leftChild p-3 d-flex flex-column gap-3">
            <h6 class="m-0" id="cityName">City Name</h6>
            <h5 class="m-0"> <span id="cityTemp">0</span> &deg;C </h5>
            <h6 class="m-0" id="skyDesc">Sky Description</h6>
            <hr class="line">
            <div class="d-flex gap-3">
                <img src="assets/date.png " alt="" width="25px" >
                <h6 class="m-0" id="date">Date</h6>
            </div>
            <div class="d-flex gap-3">
                <img src="assets/time.png" alt="" width="25px">
                <h6 class="m-0" id="time">Time</h6>
            </div>
        </div>
        <div class="nextFiveDays leftChild p-3 d-flex flex-column gap-5">
            <h6 class="m-0" id="comingFiveDays">Coming Days</h6>
            <div class="d-flex flex-column gap-2 m-3">
                <div class="forecastRow d-flex align-items-center justify-content-between">
                        <div class="d-flex gap-2 align-items-center">
                            <img src="assets/cloud.png" alt="" width="35px">
                            <h6>7 &deg;C</h6>
                        </div>
                        <div id="forecastDate1"></div>

                </div>
                <div class="forecastRow d-flex align-items-center justify-content-between">
                        <div class="d-flex gap-2 align-items-center">
                            <img src="assets/cloud.png" alt="" width="35px">
                            <h6>7 &deg;C</h6>
                        </div>
                        <div id="forecastDate2"></div>
                </div>
                <div class="forecastRow d-flex align-items-center justify-content-between">
                        <div class="d-flex gap-2 align-items-center">
                            <img src="assets/cloud.png" alt="" width="35px">
                            <h6>7 &deg;C</h6>
                        </div>
                        <div id="forecastDate3"></div>
                </div>
            </div>
        </div>
    </div>


    <div class="rightDiv">
        <div class="rightRow rowOne d-flex gap-2 justify-content-between align-items-center">

           <div class="extraMetric d-flex gap-3">
            <img src="assets/wave.png" alt="" width="35px">
            <div>
                <h6 class="m-0">Metric Name</h6>
                <h6 class="m-0">Metric Value</h6>
            </div>
           </div>
           <div class="extraMetric d-flex gap-3">
            <img src="assets/wave.png" alt="" width="35px">
            <div>
                <h6 class="m-0">Metric Name</h6>
                <h6 class="m-0">Metric Value</h6>
            </div>
           </div>
           <div class="extraMetric d-flex gap-3">
            <img src="assets/wave.png" alt="" width="35px">
            <div>
                <h6 class="m-0">Metric Name</h6>
                <h6 class="m-0">Metric Value</h6>
            </div>
           </div>
           <div class="extraMetric d-flex gap-3">
            <img src="assets/wave.png" alt="" width="35px">
            <div>
                <h6 class="m-0">Metric Name</h6>
                <h6 class="m-0">Metric Value</h6>
            </div>
           </div>
        </div>

        <div class="rightRow rowTwo d-flex justify-content-between align-item-center">
          <div class="AQI rowTwoDiv p-3 d-flex flex-column gap-2">
            <h5>Air Quality Index(AQI)</h5>
              <div class="d-flex align-items-center gap-4">
                <img src="assets/wind.jpg" alt="" width="40px">
                <div class="text-center">
                    <h6 id="co">AQT Metric</h6>
                    <h6 id="coValue">0</h6>
                </div>
                <div class="text-center">
                    <h6 id="so2">AQT Metric</h6>
                    <h6 id="so2Value">0</h6>
                </div>
                <div class="text-center">
                    <h6 id="o3">AQT Metric</h6>
                    <h6 id="o3Value">0</h6>
                </div>
                <div class="text-center">
                    <h6 id="no2">AQT Metric</h6>
                    <h6 id="no2Value">0</h6>
                </div>
              </div>
          </div>

          <div class="sunRise rowTwoDiv p-3 gap-2">
            <h5 class="m-0">Sunrise & Sunset</h5>

            <div class="d-flex justify-content-between m-3">
            <div class="sunriseDiv d-flex gap-2 align-items-center">
                <img src="assets/sun.png" alt="" width="50px">
                <div class="d-flex  flex-column gap-1">
                    <h6 class="m-0">Sunrise</h6>
                    <h5 class="m-0" id="sunriseTime">6:00 Am</h5>
                </div>
            </div>
            <div class="sunsetDiv d-flex  gap-2 align-items-center">
                <img src="assets/moon.jpg" alt="" width="50px">
                <div class="d-flex flex-column gap-1">
                    <h6 class="m-0" >Sunset</h6>
                    <h5 class="m-0"  id="sunsetTime">7:00 Pm</h5>
                </div>
            </div>
          </div>
        </div>
        
        </div>



        <div class="rightRow rowThree d-flex flex-column gap-2">
          <h5 class="m-0" id="today">Today</h5>
          <div class="d-flex justify-content-between todaytempParentDiv">
            <div class="todayTemp">
                <h6 class="m-0">9:00 Am</h6>
                <img src="assets/temp.png" alt="" width="35px">
                <h5 class="m-0">15 &deg;C</h5>
            </div>
            <div class="todayTemp">
                <h6 class="m-0">9:00 Am</h6>
                <img src="assets/temp.png" alt="" width="35px">
                <h5 class="m-0">15 &deg;C</h5>
            </div>
            <div class="todayTemp">
                <h6 class="m-0">9:00 Am</h6>
                <img src="assets/temp.png" alt="" width="35px">
                <h5 class="m-0">15 &deg;C</h5>
            </div>
            <div class="todayTemp">
                <h6 class="m-0">9:00 Am</h6>
                <img src="assets/temp.png" alt="" width="35px">
                <h5 class="m-0">15 &deg;C</h5>
            </div>
            <div class="todayTemp">
                <h6 class="m-0">9:00 Am</h6>
                <img src="assets/temp.png" alt="" width="35px">
                <h5 class="m-0">15 &deg;C</h5>
            </div>
            <div class="todayTemp">
                <h6 class="m-0">9:00 Am</h6>
                <img src="assets/temp.png" alt="" width="35px">
                <h5 class="m-0">15 &deg;C</h5>
            </div>
          </div>
        </div>
    </div>

   </div>





    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>  </body>
     
    <script
  src="https://code.jquery.com/jquery-3.7.1.js"
  integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
  crossorigin="anonymous"></script>

  <script>
    function dateFormat(timestamp) {
        const date = new Date(timestamp * 1000);
        console.log(date.toUTCString());
        console.log(date.toLocaleString());
        return date.toLocaleString();
    }

    async function fetchAQIData(lat, lon) {
    let fetchAQIData = await fetch(`http://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=d28274b5fe592e1f1e558103a5e66370`)
    let formattedData = await fetchAQIData.json();
    console.log('AQI Data: ', formattedData);
    let list = formattedData.list[0].components;

    $("#no2")[0].innerText = 'NO2';
    $("#no2Value")[0].innerText = list.no2;

    $("#o3")[0].innerText = 'O3';
    $("#o3Value")[0].innerText = list.o3;

    $("#co")[0].innerText = 'CO';
    $("#coValue")[0].innerText = list.co;

    $("#so2")[0].innerText = 'SO2';
    $("#so2Value")[0].innerText = list.so2;
}

async function fetch5DayForecast(cityName) {
    let forecastData = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${cityName}&appid=d28274b5fe592e1f1e558103a5e66370&units=metric`);
    let forecastJson = await forecastData.json();
    
    if (forecastJson.cod !== "200") {
        console.log("Error fetching forecast data");
        return;
    }

    let dailyForecasts = [];
    for (let i = 0; i < 5; i++) {
        let forecast = forecastJson.list[i * 8]; 
        let date = new Date(forecast.dt * 1000);
        let day = date.toLocaleDateString('en-US', { weekday: 'long' });
        let dateStr = date.toLocaleDateString('en-US');
        let temp = forecast.main.temp;
        let description = forecast.weather[0].description;

        dailyForecasts.push({
            date: dateStr,
            day: day,
            temp: temp,
            description: description,
        });
    }

    for (let i = 0; i < 5; i++) {
        let forecast = dailyForecasts[i];
        document.getElementById(`forecastDate${i + 1}`).innerText = forecast.date;
        document.getElementById(`forecastDay${i + 1}`).innerText = forecast.day;
        document.getElementById(`forecastTemp${i + 1}`).innerText = forecast.temp + '°C';
        document.getElementById(`forecastDesc${i + 1}`).innerText = forecast.description;
    }
}

async function fetchData() {
    let cityName = document.getElementsByClassName('inputfield')[0].value;
    console.log('Current City: ', cityName);

    let requestData = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=d28274b5fe592e1f1e558103a5e66370&units=metric`);
    let formattedData = await requestData.json();

    console.log("Formatted Data: ", formattedData);

    let responseCityName = formattedData.name;
    let responseTemp = formattedData.main.temp;
    let skyDescription = formattedData.weather[0].description;

    $('#cityName')[0].innerText = responseCityName;
    $('#cityTemp')[0].innerText = responseTemp;
    $('#skyDesc')[0].innerText = skyDescription;

    let properDate = dateFormat(formattedData.dt);
    let date = properDate.split(',')[0];
    let time = properDate.split(',')[1];
    $("#date")[0].innerText = date;
    $("#time")[0].innerText = time;

    fetch5DayForecast(cityName);
}

function dateFormat(timestamp) {
    const date = new Date(timestamp * 1000);
    return date.toLocaleString();
}
  </script>

</html>